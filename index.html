<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>南京三日行程規劃</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Noto+Sans+TC:wght@400;500;700&display=swap');

        body {
            font-family: 'Roboto', 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent;
            background-color: #fef7ff;
            /* M3 Surface */
        }

        /* Custom Scrollbar Hiding */
        .custom-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .custom-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s cubic-bezier(0.2, 0.0, 0, 1.0) forwards;
            opacity: 0;
        }

        .slide-up {
            animation: slideUp 0.6s cubic-bezier(0.2, 0.0, 0, 1.0) forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Modal transitions */
        .modal-enter {
            transform: translateY(0) !important;
        }

        .backdrop-enter {
            opacity: 1 !important;
            pointer-events: auto !important;
        }

        /* M3 Elevation & States */
        .m3-card {
            background-color: #f3f4f9;
            /* Surface Container Low */
            transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
        }

        .m3-card:active {
            background-color: #e2e2e9;
            /* Surface Container High */
            transform: scale(0.98);
        }

        .m3-chip {
            border: 1px solid transparent;
        }
    </style>
</head>

<body class="text-[#1d1b20] selection:bg-[#e8def8] selection:text-[#1d1b20] pb-24 touch-manipulation">

    <!-- Small Top App Bar -->
    <div
        class="sticky top-0 z-20 bg-[#fef7ff]/95 backdrop-blur-md border-b border-[#cac4d0]/50 transition-all duration-200">
        <div class="max-w-md mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <!-- Leading Icon (optional, could be menu) 
               <button class="p-2 -ml-2 rounded-full hover:bg-[#1d1b20]/[0.08] active:bg-[#1d1b20]/[0.12]">
                   <i data-lucide="menu" width="24"></i>
               </button>
               -->
                <div class="flex flex-col">
                    <h1 class="text-[22px] leading-7 font-normal text-[#1d1b20]">南京行程</h1>
                    <p class="text-xs font-medium text-[#49454f] tracking-wide">Dec 29 - 31</p>
                </div>
            </div>

            <button
                class="w-10 h-10 rounded-full flex items-center justify-center text-[#49454f] hover:bg-[#1d1b20]/[0.08] active:bg-[#1d1b20]/[0.12] transition-colors">
                <i data-lucide="share-2" width="24"></i>
            </button>
        </div>
    </div>

    <!-- Main Schedule Container -->
    <div id="app-container" class="px-4 pt-4 space-y-8 max-w-md mx-auto">
        <!-- Content injected by JS -->
    </div>

    <!-- Scrim (Backdrop) -->
    <div id="modal-backdrop" onclick="closeModal()"
        class="fixed inset-0 z-50 bg-[#1d1b20]/40 backdrop-blur-[2px] transition-opacity duration-300 opacity-0 pointer-events-none">
    </div>

    <!-- Modal (Standard Bottom Sheet) -->
    <div id="modal-sheet"
        class="fixed inset-x-0 bottom-0 z-50 flex justify-center pointer-events-none transition-transform duration-400 ease-[cubic-bezier(0.2,0,0,1)] translate-y-full">
        <!-- Material Surface Container Low/Lowest -->
        <div
            class="bg-[#f7f2fa] w-full max-w-md rounded-t-[28px] shadow-[0_-4px_20px_-5px_rgba(0,0,0,0.15)] overflow-hidden relative flex flex-col max-h-[92vh] pointer-events-auto">

            <!-- Drag Handle -->
            <div class="w-full flex justify-center pt-4 pb-2" onclick="closeModal()">
                <div class="w-8 h-1 bg-[#79747e] rounded-full opacity-40"></div>
            </div>

            <!-- Modal Content -->
            <div id="modal-content" class="overflow-y-auto pb-12 custom-scrollbar">
                <!-- Injected by JS -->
            </div>
        </div>
    </div>

    <script>
        // --- Data Source ---
        const scheduleData = [
            {
                date: "12/29",
                day: "第一天",
                theme: "金陵帝王氣",
                sections: [
                    {
                        period: "早上",
                        spots: [
                            {
                                name: "玄武湖",
                                timeDisplay: "全天開放",
                                bookingStatus: null,
                                shortDesc: "金陵明珠，皇家園林",
                                mustVisit: ["環洲煙柳", "櫻洲花海", "菱洲", "從湖面看城牆"],
                                detail: {
                                    year: "始於秦漢 (約西元前200年)",
                                    title: "中國僅存的江南皇家園林",
                                    history: "玄武湖古名桑泊，至今已有兩千三百年歷史。六朝時期為皇家園林及操練水軍之所。明朝朱元璋定都南京後，將其闢為國家級檔案館（黃冊庫），成為禁地長達 260 餘年，直至清末才重新對外開放。這裡是歷代文人墨客與帝王將相流連之地，見證了南京城的繁華與滄桑。",
                                    features: "湖岸呈菱形，周長約 10 公里，五洲分佈其中。這裡曾是明朝存放「黃冊」的聖地，也是世界上最早、最大的皇家檔案庫遺址。每逢夏日荷花盛開或秋日銀杏金黃，景色更是醉人。",
                                    highlight: "這裡是中國歷代皇室保留最完整的城市湖泊公園，也是欣賞南京城牆最美的角度。特別推薦沿著環洲漫步，感受那份遠離塵囂的靜謐與皇家氣派。"
                                }
                            },
                            {
                                name: "雞鳴寺",
                                timeDisplay: "17:00 閉園",
                                bookingStatus: null,
                                shortDesc: "南朝四百八十寺之首",
                                mustVisit: ["藥師佛塔", "古胭脂井", "素齋麵館", "櫻花大道"],
                                detail: {
                                    year: "始建於西晉永康元年 (西元300年)",
                                    title: "南朝第一寺，皇室佛緣",
                                    history: "前身是三國東吳的棲玄寺，後成為南朝梁武帝蕭衍興建的同泰寺。梁武帝曾在此四次捨身出家，使這裡成為南朝佛教中心。古井「胭脂井」更是見證了陳後主與張麗華亡國前的最後時刻，充滿了歷史的唏噓。",
                                    features: "寺廟依山而建，錯落有致，亮黃色的牆體與黑色的瓦片在南京的寺廟中獨樹一幟。藥師佛塔高聳入雲，是南京城北的地標建築。寺內的素麵館更是遠近馳名，湯頭鮮美。",
                                    highlight: "「南朝四百八十寺，多少樓台煙雨中」，雞鳴寺即是這句千古絕唱的靈感來源與核心代表。香火極旺，據說求姻緣特別靈驗。"
                                }
                            },
                            {
                                name: "南京城牆",
                                timeDisplay: "21:00 閉園",
                                bookingStatus: null,
                                shortDesc: "世界第一大城垣",
                                mustVisit: ["登城口", "城磚銘文", "遠眺紫金山", "城牆博物館"],
                                detail: {
                                    year: "始建於西元1366年",
                                    title: "世界最長、規模最大、保存最原真的古城垣",
                                    history: "朱元璋採納朱升「高築牆」的建議，動用 162 個縣的百姓，耗費 3.5 億塊城磚，歷時 28 年建成。它不僅是一道軍事防線，更是皇權的絕對象徵。每一塊城磚都刻有燒製者與監造官的名字，建立了嚴格的責任追究制度。",
                                    features: "南京城牆依山傍水而建，蜿蜒曲折，打破了傳統方正的城牆規制，展現了「天人合一」的設計理念。牆體厚實堅固，經歷六百多年風雨仍屹立不倒。",
                                    highlight: "在城牆上漫步，一邊是現代化的都市高樓，一邊是滄桑的古色古香，古今交融的視覺衝擊令人震撼。推薦從雞鳴寺段登城，風景最佳。"
                                }
                            },
                            {
                                name: "明故宮遺址公園",
                                timeDisplay: "18:30 閉園",
                                bookingStatus: null,
                                shortDesc: "北京故宮的藍本",
                                mustVisit: ["午門五鳳樓", "奉天殿石基", "內五龍橋", "巨型石柱礎"],
                                detail: {
                                    year: "始建於明洪武年間 (西元1366年)",
                                    title: "中世紀世界最大的宮殿建築群",
                                    history: "明故宮是北京紫禁城的原型與藍本。朱元璋在此登基，開創了明清兩代宮殿建築的最高規格。雖然地面宏偉建築毀於戰火，但其佈局深刻影響了後世的都城規劃。",
                                    features: "從現存保留完整的午門、內五龍橋和巨大的石柱礎，仍可想像當年的恢弘氣勢。午門的「五鳳樓」依舊巍峨，是明代宮殿建築的精華。",
                                    highlight: "這裡是中國古代都城宮殿建築的集大成者，被譽為「北京故宮之母」。漫步在巨大的石基之間，彷彿能聽到歷史的迴響。"
                                }
                            },
                            {
                                name: "國民政府主席官邸",
                                timeDisplay: "18:00 閉館",
                                bookingStatus: "已預約",
                                shortDesc: "美齡宮，遠東第一別墅",
                                mustVisit: ["空中項鍊俯覽", "蔣宋臥室", "凱迪拉克", "地下廚房"],
                                detail: {
                                    year: "建成於1934年",
                                    title: "蔣介石與宋美齡的官邸",
                                    history: " formally 稱為「國民政府主席官邸」，因蔣介石與宋美齡常居於此，俗稱「美齡宮」。這裡不僅是他們的住所，也是接待外國貴賓的重要場所，見證了民國黃金十年的外交與政治生活。",
                                    features: "建築風格中西合璧，外觀是傳統的中國宮殿式大屋頂，覆蓋綠色琉璃瓦，內部則是豪華的西式別墅裝修。最為人稱道的是，從高空俯瞰，陵園路兩旁的梧桐樹如同一條金色的項鍊，而美齡宮正是這條項鍊上璀璨的綠寶石。",
                                    highlight: "被譽為「遠東第一別墅」，其設計細節極盡考究，展現了民國時期頂級的審美與工藝，是了解民國上層生活方式的絕佳窗口。"
                                }
                            }
                        ]
                    },
                    {
                        period: "晚上",
                        spots: [
                            {
                                name: "中華門 (甕城)",
                                timeDisplay: "21:00 閉園",
                                bookingStatus: null,
                                shortDesc: "天下第一甕城",
                                mustVisit: ["藏兵洞", "千斤閘遺跡", "馬道", "甕城結構"],
                                detail: {
                                    year: "建於明初 (西元1366年-1386年)",
                                    title: "世界上保存最完整的地下軍事要塞",
                                    history: "中華門原名聚寶門，是南京城牆十三座城門中最大的一座。其設計初衷是為了能在戰時「誘敵深入、聚而殲之」。這裡設有三道甕城、四道拱門，佈局嚴密驚人。",
                                    features: "最令人驚嘆的是城門內的「藏兵洞」，共有 27 個，可容納 3,000 名伏兵。洞內冬暖夏涼，並設有通風口與傳聲孔，展現了極高的軍事智慧與建築工藝。",
                                    highlight: "藏兵洞的規模與設計精密度為中國首位，親身走入洞中，能強烈感受到古代戰爭的緊張氛圍與防禦工事的宏大。"
                                }
                            },
                            {
                                name: "老門東",
                                timeDisplay: "全天開放",
                                bookingStatus: "推薦",
                                shortDesc: "最南京的市井煙火",
                                mustVisit: ["駿惠書屋", "金陵刻經處", "梅花糕", "芥子園"],
                                detail: {
                                    year: "追溯至三國時期 (西元220年)",
                                    title: "南京老城南的核心歷史街區",
                                    history: "老門東位於中華門以東，自古是江南商賈雲集、人文薈萃之地。這裡是南京傳統民居保存最完整的區域，見證了老城南的商貿興盛與市井百態。",
                                    features: "街區內保留了大量明清風格的民居，馬頭牆、石板路與花格窗隨處可見，構成了典型的蘇派建築風格。這裡還隱藏著許多文化遺產，如金陵刻經處。",
                                    highlight: "這裡的「梅花糕」、「鴨血粉絲湯」與「小鄭酥燒餅」是公認的南京味蕾名片。在轉角遇見駿惠書屋（先鋒書店），則是另一番文化驚喜。"
                                }
                            },
                            {
                                name: "夫子廟",
                                timeDisplay: "全天開放",
                                bookingStatus: "推薦",
                                shortDesc: "中國四大文廟之一",
                                mustVisit: ["大成殿", "江南貢院", "烏衣巷", "秦淮河夜景"],
                                detail: {
                                    year: "始建於東晉 (西元337年)",
                                    title: "中國第一所國家最高學府",
                                    history: "夫子廟是孔廟、學宮、貢院組成的龐大建築群。江南貢院曾是中國最大的科舉考場，明清時期全中國半數以上的狀元均出自於此。烏衣巷更是王導、謝安等豪門望族的居住地。",
                                    features: "建築依秦淮河而建，形成了「廟在河邊，街在廟旁」的獨特佈局。這裡不僅是儒家文化的聖地，更是秦淮河畔世俗繁華的中心。",
                                    highlight: "它是儒家文化與秦淮風情的完美融合。夜晚的夫子廟燈火輝煌，秦淮河上畫舫穿梭，是體驗「十里秦淮」夢幻景致的最佳地點。"
                                }
                            }
                        ]
                    }
                ]
            },
            {
                date: "12/30",
                day: "第二天",
                theme: "民國與史詩",
                sections: [
                    {
                        period: "早上",
                        spots: [
                            {
                                name: "南京博物院",
                                timeDisplay: "17:00 閉館",
                                bookingStatus: "已預約",
                                shortDesc: "中國三大博物館之一",
                                mustVisit: ["民國館 (穿越時空)", "金獸 (鎮館之寶)", "大報恩寺琉璃拱門"],
                                detail: {
                                    year: "創建於1933年",
                                    title: "中國第一座由國家投資興建的大型博物館",
                                    history: "前身是蔡元培倡議的國立中央博物院，與北京故宮、台北故宮並稱為中國三大博物館。館藏文物超過 43 萬件，是中國近代考古學與博物館學的發祥地之一。",
                                    features: "博物院分為歷史館、特展館、數字館、藝術館、民國館、非遺館六大展館。其中地下「民國館」最為獨特，完整還原了 1930 年代南京的街景，包括老火車站、郵局與店鋪。",
                                    highlight: "「民國館」提供完全沉浸式的體驗，讓人瞬間穿越回民國時期。鎮館之寶「金獸」與「釉裡紅歲寒三友紋梅瓶」更是稀世珍寶，不可錯過。"
                                }
                            }
                        ]
                    },
                    {
                        period: "下午",
                        spots: [
                            {
                                name: "總統府",
                                timeDisplay: "17:00 閉園",
                                bookingStatus: "已預約",
                                note: "黃炘苡手機",
                                shortDesc: "半部近代史",
                                mustVisit: ["子超樓", "煦園", "孫中山臨時大總統辦公室", "行政院大樓"],
                                detail: {
                                    year: "明漢王府、清總督署、民國總統府",
                                    title: "中國近代史遺存博物館",
                                    history: "這塊土地的歷史極其厚重：明朝是漢王府，清朝是康熙乾隆下江南的行宮及兩江總督署，太平天國這裡是天王府，民國時期則是國民政府總統府。孫中山先生也在此就任臨時大總統。",
                                    features: "建築風格極其複雜而精彩，既有江南園林「煦園」的婉約精緻，又有歐式政務大樓「子超樓」的莊嚴肅穆，是中西文化與多個朝代共存的建築標本。",
                                    highlight: "走進「子超樓」，可以看到當年蔣介石、李宗仁的辦公室原貌。這裡的每一磚一瓦都訴說著中國近代百年的風雲變幻，是必讀的歷史教科書。"
                                }
                            },
                            {
                                name: "南京大屠殺紀念館",
                                timeDisplay: "17:00 閉館",
                                bookingStatus: "待預約",
                                shortDesc: "勿忘國恥，和平之聲",
                                mustVisit: ["萬人坑遺址", "12秒水滴", "和平女神像", "冥思廳"],
                                detail: {
                                    year: "建成於1985年",
                                    title: "中國首批國家一級博物館",
                                    history: "全名為侵華日軍南京大屠殺遇難同胞紀念館，選址於當年日軍大屠殺遺址之一的「江東門萬人坑」。這是一座關於傷痛、記憶、反思與和平的紀念性建築。",
                                    features: "建築設計以「生與死」、「痛與恨」為主題，大量採用灰白石材與碎石，外形如同斷裂的軍刀。內部設計冷峻肅穆，視覺與心靈的衝擊力極強。",
                                    highlight: "著名的「12秒水滴」裝置，每隔12秒滴落一滴水，象徵著在常規大屠殺期間每12秒就有一個生命消逝，令人震撼且悲痛，是銘記歷史、祈願和平的聖地。"
                                }
                            }
                        ]
                    },
                    {
                        period: "晚上",
                        spots: [
                            {
                                name: "南京長江大橋",
                                timeDisplay: "全天開放",
                                bookingStatus: null,
                                shortDesc: "中國人的爭氣橋",
                                mustVisit: ["橋頭堡", "公鐵兩用橋面", "玉蘭花路燈", "玻璃棧道"],
                                detail: {
                                    year: "1968年全面通車",
                                    title: "第一座由中國自行設計建造的雙層鐵路、公路兩用橋",
                                    history: "在1960年代中蘇關係破裂、蘇聯撤走專家且物資匱乏的艱難背景下，中國人靠自己的力量建成了這座奇蹟。它不僅是長江上重要的交通樞紐，更是那個時代自力更生精神的圖騰。",
                                    features: "大橋分為上下兩層，上層為公路，下層為鐵路。橋頭堡上高聳的工農兵雕塑極具鮮明的時代特色。公路兩側排列著 299 根玉蘭花形狀的路燈，夜晚亮燈時如同一條火龍。",
                                    highlight: "站在橋頭堡俯瞰滾滾長江東逝水，氣勢磅礴。這座橋承載了幾代人的集體記憶，被視為南京乃至中國的驕傲。"
                                }
                            }
                        ]
                    }
                ]
            },
            {
                date: "12/31",
                day: "第三天",
                theme: "鍾山風雨",
                sections: [
                    {
                        period: "白天",
                        spots: [
                            {
                                name: "中山陵",
                                timeDisplay: "17:00 閉園",
                                bookingStatus: "待預約",
                                shortDesc: "近代建築史上的第一陵",
                                mustVisit: ["博愛坊", "392級台階", "祭堂坐像", "天下為公匾"],
                                detail: {
                                    year: "建成於1929年",
                                    title: "孫中山先生陵墓，國之聖地",
                                    history: "孫中山先生逝世後，遵照其遺願葬於南京紫金山。陵墓由建築師呂彥直設計，融合了中國古代宮殿建築與西方現代建築美學。整個陵寢依山而建，氣勢宏偉。",
                                    features: "從空中俯瞰，整個陵墓平面呈「自由鐘」狀，寓意喚起民眾。從博愛坊到祭堂，共有 392 級台階，象徵當時中國的三億九千兩百萬同胞。",
                                    highlight: "它是中國近代建築史上最傑出的範例之一。登上最高處回望，視野開闊，既能感受到建築的莊嚴肅穆，也能緬懷孫中山先生的偉大精神。"
                                }
                            },
                            {
                                name: "明孝陵",
                                timeDisplay: "18:00 閉園",
                                bookingStatus: null,
                                shortDesc: "明清皇家陵寢之首",
                                mustVisit: ["石象路", "文武方門", "方城明樓", "寶頂"],
                                detail: {
                                    year: "始建於西元1381年",
                                    title: "中國古代最大的帝王陵寢之一",
                                    history: "明太祖朱元璋與馬皇后的合葬陵墓。耗費巨資與人力，歷時 30 餘年才建成。清代康熙、乾隆下江南時均曾親往祭掃，以示對明朝正統的尊重。",
                                    features: "神道石刻是南京最美的風景之一，尤其是石象路，兩旁的石獸威嚴聳立，配上秋季的梧桐與銀杏，美不勝收。陵寢佈局宏大，規制嚴謹。",
                                    highlight: "明孝陵開創了明清皇陵「前方後圓」的陵寢規制，對後世五百年的帝陵形制產生了深遠影響，被列為世界文化遺產。"
                                }
                            },
                            {
                                name: "蔣陵 (孫權墓)",
                                timeDisplay: "全天開放",
                                bookingStatus: null,
                                shortDesc: "三國大帝長眠處",
                                mustVisit: ["梅花山步道", "孫權紀念館", "石像生"],
                                detail: {
                                    year: "三國時期 (約西元252年)",
                                    title: "南京地區最早的帝王陵墓",
                                    history: "位於梅花山。傳說朱元璋建明孝陵時，為了神道走向，本應遷走孫權墓，但他佩服孫權是條好漢，特意下令「孫權也是一條好漢，留著給我看門吧」，將其保留在神道之側。",
                                    features: "雖無地上宏偉建築，但梅花山本身就是一座巨大的陵墓封土。這裡如今是南京著名的賞梅勝地，古蹟與自然景觀完美結合。",
                                    highlight: "在梅花盛開的季節，花海之下長眠著這位東吳大帝，歷史的厚重與自然的浪漫在此交會，令人遐想。"
                                }
                            }
                        ]
                    }
                ]
            }
        ];

        // --- Render Helpers ---

        function renderTimeBadge(time) {
            // M3 Assist Chip Style
            const isAlwaysOpen = time.includes("全天") || time.includes("常開");

            // bg-surface-container-high / text-on-surface-variant
            const baseClasses = "inline-flex items-center px-3 py-1.5 rounded-lg text-[11px] font-medium tracking-wide transition-all border border-[#79747e]/20";

            // For closed times/warnings, use Error Container
            const containerClass = isAlwaysOpen
                ? "bg-transparent text-[#49454f]"
                : "bg-[#ffdad6] text-[#410002] border-[#ffdad6]"; // Error Container

            return `
                <span class="${baseClasses} ${containerClass}">
                    <i data-lucide="clock" width="12" class="mr-1.5"></i>
                    ${time}
                </span>
            `;
        }

        function renderBookingBadge(status, note) {
            if (!status && !note) return '';

            // M3 Filter Chip / Suggestion Chip aesthetics
            let bgClass, textClass, icon;

            if (status === "已預約") {
                // Secondary Container
                bgClass = "bg-[#e8def8]";
                textClass = "text-[#1d192b]";
                icon = "check";
            } else if (status === "待預約") {
                // Tertiary Container
                bgClass = "bg-[#ffd8e4]";
                textClass = "text-[#31111d]";
                icon = "alert-circle";
            } else { // 推薦 (Recommend) - Primary Container
                bgClass = "bg-[#eaddff]";
                textClass = "text-[#21005d]";
                icon = "star";
            }

            let html = '<div class="flex flex-col items-end gap-2 mb-2">';

            if (status) {
                html += `
                    <span class="inline-flex items-center px-2 py-1 rounded-lg text-xs font-medium ${bgClass} ${textClass}">
                        <i data-lucide="${icon}" width="14" class="mr-1.5"></i>
                        ${status}
                    </span>
                `;
            }

            if (note) {
                // Surface Variant
                html += `
                    <span class="text-[10px] text-[#49454f] bg-[#e7e0ec] px-2 py-1 rounded-md font-medium">
                        ${note}
                    </span>
                `;
            }

            html += '</div>';
            return html;
        }

        function findSpot(name) {
            for (const day of scheduleData) {
                for (const section of day.sections) {
                    for (const spot of section.spots) {
                        if (spot.name === name) return spot;
                    }
                }
            }
            return null;
        }

        // --- Main Render Function ---

        function renderApp() {
            const container = document.getElementById('app-container');
            let html = '';

            scheduleData.forEach((day, dayIdx) => {
                const delayStr = `${dayIdx * 120}ms`;

                html += `
                <div class="fade-in slide-up" style="animation-delay: ${delayStr}">
                    <!-- Date Header (Headline Small) -->
                    <div class="mb-5 pl-1 flex items-baseline gap-3">
                        <span class="text-3xl font-normal text-[#1d1b20]">${day.date}</span>
                        <span class="text-sm font-medium text-[#6750a4] bg-[#e8def8] px-2 py-0.5 rounded-md">${day.day}</span>
                        <span class="text-xs text-[#49454f] font-medium tracking-wide uppercase ml-auto">${day.theme}</span>
                    </div>

                    <!-- Timeline / List items -->
                    <div class="space-y-4 pl-4 border-l-2 border-[#e7e0ec] ml-1.5">
                        ${day.sections.map(section => `
                            <div class="relative">
                                <h3 class="text-xs font-medium text-[#49454f] uppercase tracking-wider mb-2 pl-2">
                                    ${section.period}
                                </h3>

                                <div class="space-y-3">
                                    ${section.spots.map(spot => `
                                        <div onclick="openModal('${spot.name}')"
                                             class="m3-card relative overflow-hidden rounded-[20px] p-4 cursor-pointer">
                                            
                                            <!-- Ripple Target (handled by CSS active state) -->
                                            <div class="flex justify-between items-start">
                                                <div class="flex-1 mr-4">
                                                    <h4 class="text-lg font-medium text-[#1d1b20] mb-1">
                                                        ${spot.name}
                                                    </h4>
                                                    <p class="text-sm text-[#49454f] leading-relaxed mb-3 line-clamp-1">
                                                        ${spot.shortDesc}
                                                    </p>
                                                    ${renderTimeBadge(spot.timeDisplay)}
                                                </div>
                                                
                                                <div class="flex flex-col items-end">
                                                    ${renderBookingBadge(spot.bookingStatus, spot.note)}
                                                    
                                                    <!-- Icon Button (Standard) -->
                                                    <div class="mt-1 w-8 h-8 rounded-full flex items-center justify-center text-[#49454f] bg-[#e7e0ec]/50">
                                                        <i data-lucide="chevron-right" width="20"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                `;
            });

            container.innerHTML = html;
            lucide.createIcons();
        }

        // --- Modal Logic ---

        function openModal(spotName) {
            const spot = findSpot(spotName);
            if (!spot) return;

            const content = document.getElementById('modal-content');
            content.innerHTML = `
                <!-- Header (Headline) -->
                <div class="px-6 pb-6">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex-1 pr-4">
                            <div class="flex items-center text-[#6750a4] text-[11px] font-medium tracking-widest uppercase mb-1">
                                <i data-lucide="map-pin" width="12" class="mr-1.5"></i>
                                NANJING
                            </div>
                            <h2 class="text-[28px] font-normal text-[#1d1b20] leading-tight mb-2">${spot.name}</h2>
                            <span class="inline-flex items-center bg-[#6750a4] text-white px-2.5 py-1 rounded-md text-xs font-medium">
                                ${spot.detail.year}
                            </span>
                        </div>
                        
                        <!-- Close Button (Icon Button) -->
                        <button onclick="closeModal()" class="w-10 h-10 rounded-full bg-[#f3f4f9] text-[#49454f] flex items-center justify-center active:bg-[#e7e0ec]">
                            <i data-lucide="x" width="24"></i>
                        </button>
                    </div>

                    <div class="space-y-6 mt-4">
                        <!-- History Section -->
                        <section>
                            <h3 class="text-sm font-medium text-[#6750a4] mb-2">歷史沿革</h3>
                            <p class="text-[15px] text-[#49454f] leading-7 text-justify">
                                ${spot.detail.history}
                            </p>
                        </section>

                        <!-- Must Visit (Secondary Container) -->
                        <section class="bg-[#e8def8]/40 p-5 rounded-[20px]">
                            <h3 class="text-xs font-bold text-[#6750a4] uppercase tracking-wider mb-4 flex items-center">
                                <i data-lucide="eye" width="16" class="mr-2"></i>
                                必看重點
                            </h3>
                            <div class="flex flex-wrap gap-2">
                                ${spot.mustVisit.map(item => `
                                    <div class="bg-[#fef7ff] px-3 py-1.5 rounded-lg shadow-sm border border-[#cac4d0]/20 flex items-center gap-2">
                                        <i data-lucide="camera" width="14" class="text-[#6750a4] shrink-0"></i>
                                        <span class="text-sm text-[#1d1b20]">${item}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </section>

                        <!-- Features & Highlight -->
                        <section>
                            <h3 class="text-sm font-medium text-[#6750a4] mb-2">特色與地位</h3>
                            <p class="text-[15px] text-[#49454f] leading-7 mb-6">
                                ${spot.detail.features}
                            </p>

                            <!-- Highlight Card (Tertiary Container equivalent) -->
                            <div class="bg-[#ffd8e4]/40 p-6 rounded-[24px] text-[#31111d] relative overflow-hidden">
                                <div class="absolute -right-4 -top-4 text-[#ffd8e4] opacity-100 mix-blend-multiply">
                                    <i data-lucide="star" width="80" fill="#ffd8e4" stroke="none"></i>
                                </div>
                                <p class="text-[11px] font-bold text-[#cf1e66] uppercase tracking-widest mb-2 opacity-80">知識精華</p>
                                <p class="text-base font-medium relative z-10 leading-snug">
                                    ${spot.detail.highlight}
                                </p>
                            </div>
                        </section>
                    </div>

                    <!-- Footer Meta -->
                    <div class="mt-8 pt-4 border-t border-[#cac4d0]/30">
                         <div class="inline-flex items-center text-[#410002] bg-[#ffdad6] px-4 py-2 rounded-xl text-sm font-medium">
                            <i data-lucide="clock" width="16" class="mr-2"></i>
                            ${spot.timeDisplay}
                        </div>
                    </div>
                </div>
            `;

            lucide.createIcons();

            const backdrop = document.getElementById('modal-backdrop');
            const sheet = document.getElementById('modal-sheet');

            backdrop.classList.add('backdrop-enter');
            sheet.classList.add('modal-enter');

            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const backdrop = document.getElementById('modal-backdrop');
            const sheet = document.getElementById('modal-sheet');

            backdrop.classList.remove('backdrop-enter');
            sheet.classList.remove('modal-enter');

            setTimeout(() => {
                document.body.style.overflow = '';
            }, 300);
        }

        // Initialize
        renderApp();
    </script>
</body>

</html>
